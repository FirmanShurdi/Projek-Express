{"version":3,"sources":["users.js"],"names":["express","require","router","Router","connection","get","req","res","query","err","rows","console","log","flash","message","redirect","length","render","data","messages","success","error","post","body","username","password","email","role","id","params","user","module","exports"],"mappings":";;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAMC,MAAM,GAAGF,OAAO,CAACG,MAAR,EAAf;;AACA,IAAMC,UAAU,GAAGH,OAAO,CAAC,OAAD,CAA1B,C,CAEA;;;AACAC,MAAM,CAACG,GAAP,CAAW,GAAX,EAAgB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC5BH,EAAAA,UAAU,CAACI,KAAX,CAAiB,sCAAjB,EAAyD,UAACC,GAAD,EAAMC,IAAN,EAAe;AACtE,QAAID,GAAJ,EAAS;AACPE,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBH,GAAtB,EADO,CACqB;;AAC5BH,MAAAA,GAAG,CAACO,KAAJ,CAAU,OAAV,EAAmB,2BAA2BJ,GAAG,CAACK,OAAlD;AACA,aAAOP,GAAG,CAACQ,QAAJ,CAAa,GAAb,CAAP;AACD;;AAEDJ,IAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCF,IAAI,CAACM,MAA3C,EAPsE,CAOlB;;AAEpDT,IAAAA,GAAG,CAACU,MAAJ,CAAW,aAAX,EAA0B;AACxBC,MAAAA,IAAI,EAAER,IADkB;AAExBS,MAAAA,QAAQ,EAAE;AACRC,QAAAA,OAAO,EAAEd,GAAG,CAACO,KAAJ,CAAU,SAAV,CADD;AAERQ,QAAAA,KAAK,EAAEf,GAAG,CAACO,KAAJ,CAAU,OAAV;AAFC;AAFc,KAA1B;AAOD,GAhBD;AAiBD,CAlBD,E,CAqBA;;AACAX,MAAM,CAACG,GAAP,CAAW,SAAX,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAClCA,EAAAA,GAAG,CAACU,MAAJ,CAAW,cAAX;AACD,CAFD,E,CAIA;;AACAf,MAAM,CAACoB,IAAP,CAAY,QAAZ,EAAsB,UAAChB,GAAD,EAAMC,GAAN,EAAc;AAAA,kBACUD,GAAG,CAACiB,IADd;AAAA,MAC1BC,QAD0B,aAC1BA,QAD0B;AAAA,MAChBC,QADgB,aAChBA,QADgB;AAAA,MACNC,KADM,aACNA,KADM;AAAA,MACCC,IADD,aACCA,IADD;AAElC,MAAMT,IAAI,GAAG;AAAEM,IAAAA,QAAQ,EAARA,QAAF;AAAYC,IAAAA,QAAQ,EAARA,QAAZ;AAAsBC,IAAAA,KAAK,EAALA,KAAtB;AAA6BC,IAAAA,IAAI,EAAJA;AAA7B,GAAb;AAEAvB,EAAAA,UAAU,CAACI,KAAX,CAAiB,yBAAjB,EAA4CU,IAA5C,EAAkD,UAACT,GAAD,EAAS;AACzD,QAAIA,GAAJ,EAAS;AACPH,MAAAA,GAAG,CAACO,KAAJ,CAAU,OAAV,EAAmB,2BAA2BJ,GAAG,CAACK,OAAlD;AACD,KAFD,MAEO;AACLR,MAAAA,GAAG,CAACO,KAAJ,CAAU,SAAV,EAAqB,yBAArB;AACD;;AACDN,IAAAA,GAAG,CAACQ,QAAJ,CAAa,QAAb;AACD,GAPD;AAQD,CAZD,E,CAcA;;AACAb,MAAM,CAACG,GAAP,CAAW,WAAX,EAAwB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACpC,MAAMqB,EAAE,GAAGtB,GAAG,CAACuB,MAAJ,CAAWD,EAAtB;AAEAxB,EAAAA,UAAU,CAACI,KAAX,CAAiB,kCAAjB,EAAqD,CAACoB,EAAD,CAArD,EAA2D,UAACnB,GAAD,EAAMC,IAAN,EAAe;AACxE,QAAID,GAAG,IAAIC,IAAI,CAACM,MAAL,KAAgB,CAA3B,EAA8B;AAC5BV,MAAAA,GAAG,CAACO,KAAJ,CAAU,OAAV,EAAmB,sBAAnB;AACA,aAAON,GAAG,CAACQ,QAAJ,CAAa,QAAb,CAAP;AACD;;AAEDR,IAAAA,GAAG,CAACU,MAAJ,CAAW,YAAX,EAAyB;AAAEa,MAAAA,IAAI,EAAEpB,IAAI,CAAC,CAAD;AAAZ,KAAzB;AACD,GAPD;AAQD,CAXD,E,CAaA;;AACAR,MAAM,CAACoB,IAAP,CAAY,aAAZ,EAA2B,UAAChB,GAAD,EAAMC,GAAN,EAAc;AACvC,MAAMqB,EAAE,GAAGtB,GAAG,CAACuB,MAAJ,CAAWD,EAAtB;AADuC,mBAEKtB,GAAG,CAACiB,IAFT;AAAA,MAE/BC,QAF+B,cAE/BA,QAF+B;AAAA,MAErBC,QAFqB,cAErBA,QAFqB;AAAA,MAEXC,KAFW,cAEXA,KAFW;AAAA,MAEJC,IAFI,cAEJA,IAFI;AAGvC,MAAMT,IAAI,GAAG;AAAEM,IAAAA,QAAQ,EAARA,QAAF;AAAYC,IAAAA,QAAQ,EAARA,QAAZ;AAAsBC,IAAAA,KAAK,EAALA,KAAtB;AAA6BC,IAAAA,IAAI,EAAJA;AAA7B,GAAb;AAEAvB,EAAAA,UAAU,CAACI,KAAX,CAAiB,iCAAjB,EAAoD,CAACU,IAAD,EAAOU,EAAP,CAApD,EAAgE,UAACnB,GAAD,EAAS;AACvE,QAAIA,GAAJ,EAAS;AACPH,MAAAA,GAAG,CAACO,KAAJ,CAAU,OAAV,EAAmB,6BAA6BJ,GAAG,CAACK,OAApD;AACD,KAFD,MAEO;AACLR,MAAAA,GAAG,CAACO,KAAJ,CAAU,SAAV,EAAqB,2BAArB;AACD;;AACDN,IAAAA,GAAG,CAACQ,QAAJ,CAAa,QAAb;AACD,GAPD;AAQD,CAbD,E,CAeA;;AACAb,MAAM,CAACG,GAAP,CAAW,aAAX,EAA0B,UAACC,GAAD,EAAMC,GAAN,EAAc;AACtC,MAAMqB,EAAE,GAAGtB,GAAG,CAACuB,MAAJ,CAAWD,EAAtB;AAEAxB,EAAAA,UAAU,CAACI,KAAX,CAAiB,gCAAjB,EAAmD,CAACoB,EAAD,CAAnD,EAAyD,UAACnB,GAAD,EAAS;AAChE,QAAIA,GAAJ,EAAS;AACPH,MAAAA,GAAG,CAACO,KAAJ,CAAU,OAAV,EAAmB,2BAA2BJ,GAAG,CAACK,OAAlD;AACD,KAFD,MAEO;AACLR,MAAAA,GAAG,CAACO,KAAJ,CAAU,SAAV,EAAqB,uBAArB;AACD;;AACDN,IAAAA,GAAG,CAACQ,QAAJ,CAAa,QAAb;AACD,GAPD;AAQD,CAXD;AAaAgB,MAAM,CAACC,OAAP,GAAiB9B,MAAjB","sourcesContent":["const express = require('express');\nconst router = express.Router();\nconst connection = require('../db');\n\n// Menampilkan daftar users\nrouter.get('/', (req, res) => {\n  connection.query('SELECT * FROM users ORDER BY id DESC', (err, rows) => {\n    if (err) {\n      console.log('Error:', err); // Tambahkan baris ini\n      req.flash('error', 'Gagal mengambil data: ' + err.message);\n      return res.redirect('/');\n    }\n\n    console.log('Data berhasil diambil:', rows.length); // Tambahkan baris ini\n\n    res.render('users/index', {\n      data: rows,\n      messages: {\n        success: req.flash('success'),\n        error: req.flash('error')\n      }\n    });\n  });\n});\n\n\n// Form tambah user\nrouter.get('/create', (req, res) => {\n  res.render('users/create');\n});\n\n// Simpan user baru\nrouter.post('/store', (req, res) => {\n  const { username, password, email, role } = req.body;\n  const data = { username, password, email, role };\n\n  connection.query('INSERT INTO users SET ?', data, (err) => {\n    if (err) {\n      req.flash('error', 'Gagal menyimpan data: ' + err.message);\n    } else {\n      req.flash('success', 'Berhasil menyimpan data');\n    }\n    res.redirect('/users');\n  });\n});\n\n// Form edit user\nrouter.get('/edit/:id', (req, res) => {\n  const id = req.params.id;\n\n  connection.query('SELECT * FROM users WHERE id = ?', [id], (err, rows) => {\n    if (err || rows.length === 0) {\n      req.flash('error', 'User tidak ditemukan');\n      return res.redirect('/users');\n    }\n\n    res.render('users/edit', { user: rows[0] });\n  });\n});\n\n// Update user\nrouter.post('/update/:id', (req, res) => {\n  const id = req.params.id;\n  const { username, password, email, role } = req.body;\n  const data = { username, password, email, role };\n\n  connection.query('UPDATE users SET ? WHERE id = ?', [data, id], (err) => {\n    if (err) {\n      req.flash('error', 'Gagal memperbarui data: ' + err.message);\n    } else {\n      req.flash('success', 'Berhasil memperbarui data');\n    }\n    res.redirect('/users');\n  });\n});\n\n// Hapus user\nrouter.get('/delete/:id', (req, res) => {\n  const id = req.params.id;\n\n  connection.query('DELETE FROM users WHERE id = ?', [id], (err) => {\n    if (err) {\n      req.flash('error', 'Gagal menghapus data: ' + err.message);\n    } else {\n      req.flash('success', 'Data berhasil dihapus');\n    }\n    res.redirect('/users');\n  });\n});\n\nmodule.exports = router;\n"],"file":"users.dev.js"}