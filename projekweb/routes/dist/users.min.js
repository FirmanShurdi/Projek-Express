"use strict";var express=require("express"),router=express.Router(),connection=require("../db");router.get("/",function(s,a){connection.query("SELECT * FROM users ORDER BY id DESC",function(e,r){if(e)return console.log("Error:",e),s.flash("error","Gagal mengambil data: "+e.message),a.redirect("/");console.log("Data berhasil diambil:",r.length),a.render("users/index",{data:r,messages:{success:s.flash("success"),error:s.flash("error")}})})}),router.get("/create",function(e,r){r.render("users/create")}),router.post("/store",function(r,s){var e=r.body,a={username:e.username,password:e.password,email:e.email,role:e.role};connection.query("INSERT INTO users SET ?",a,function(e){e?r.flash("error","Gagal menyimpan data: "+e.message):r.flash("success","Berhasil menyimpan data"),s.redirect("/users")})}),router.get("/edit/:id",function(s,a){var e=s.params.id;connection.query("SELECT * FROM users WHERE id = ?",[e],function(e,r){if(e||0===r.length)return s.flash("error","User tidak ditemukan"),a.redirect("/users");a.render("users/edit",{user:r[0]})})}),router.post("/update/:id",function(r,s){var e=r.params.id,a=r.body,t={username:a.username,password:a.password,email:a.email,role:a.role};connection.query("UPDATE users SET ? WHERE id = ?",[t,e],function(e){e?r.flash("error","Gagal memperbarui data: "+e.message):r.flash("success","Berhasil memperbarui data"),s.redirect("/users")})}),router.get("/delete/:id",function(r,s){var e=r.params.id;connection.query("DELETE FROM users WHERE id = ?",[e],function(e){e?r.flash("error","Gagal menghapus data: "+e.message):r.flash("success","Data berhasil dihapus"),s.redirect("/users")})}),module.exports=router;
//# sourceMappingURL=users.min.js.map
